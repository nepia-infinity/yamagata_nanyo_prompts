# Playwright環境構築ガイド (Windows)

このリポジトリは、とある官公庁が公開している生成AIを活用するためのWebサイトをスクレイピングし、データとして活用するためのものです。このガイドでは、Windows環境でPythonの仮想環境を構築し、Playwrightをインストールしてスクレイピングを実行するまでの手順を説明します。

## 目標設定加速装置 | 009
組織における目標設定の形骸化を打破し、考案・策定プロセスを劇的に短縮するためのPower Appsアプリケーション。

1. システム構成案
- UI: Power Apps（入力インターフェース、モード選択）
- Logic: Power Automate（入力内容とExcelプロンプトの結合、Copilotへのリクエスト）
- DB: Excel（「山形県南陽市プロンプト集」をベースとしたプロンプト辞書 ※参照専用）
- AI: Microsoft Copilot（目標案、KPI、アクションプランの生成）

| コード | キャラクター | 実装モード名 | 役割・目標設定のコンセプト |
|---|---|---|---|
| 001 | イワン | 超知能モード | 【組織戦略・管理職】 本部・部・課などの上位組織課題を分析し、本質的な構造変革目標を導き出します。 |
| 002 | ジェット | マッハ飛行モード | 【新規事業・企画立案】 既存の枠組みにとらわれない、市場開拓や新サービス創出のための野心的な目標を策定します。 |
| 003 | フランソワーズ | 超視覚・超聴覚モード | 【セキュリティ・ガバナンス】 周辺状況や他部署との連携を観測し、組織全体と矛盾のない精緻な目標を立案します。 |
| 004 | ハインリヒ | 全身兵器モード | 【KPI・定量特化】 全身に装備された武器（指標）を繰り出すように、達成を証明する具体的な数値を大量に生成します。 |
| 005 | ジェロニモ | 強化皮膚・怪力モード | 【製造現場・寄り添い支援】 100万馬力の力強さで、現場が着実に実行できる、足腰の強いアクションプランを策定します。 |
| 006 | 張々湖 | 火炎放射モード | 【情熱・文化醸成】 メンバーの意欲を燃え立たせるような、エモーショナルでやりがいのある目標を提案します。 |
| 007 | ブリテン | 変身モード | 【ダイバーシティ】 性別、障害、マイノリティ、ニューロダイバーシティなど、多様な視点から「誰もが活躍できる」インクルーシブな目標を策定します。 |
| 008 | ピュンマ | 水中活動モード | 【スペシャリスト】 特定の技術やドメインの専門性を深化させ、プロフェッショナルとしての価値を高める目標を策定します。 |
| 009 | ジョー | 加速装置モード | 【アジャイル・スピード】 万能型。あらゆる業務目標を、一瞬で具体的かつ測定可能な「SMARTな目標」へと変換・加速させます。 |


```
DX推進室のための目標案（009モード別）
1. 001 (イワン) モード：組織・構造変革目標
「7つの階層での原因推論」をベースに、根本的な組織課題を解決する目標です。

目標案: 「紙・Excelベースの業務プロセスを3つ特定し、Power Platformによる標準化・デジタル化を実現することで、対象部門のリードタイムを20%削減する」

狙い: ツールを入れること自体を目的化せず、その先にある「業務構造の変革」を評価指標にします。

2. 009 (ジョー) モード：加速・効率化目標
「SMARTゴール」を適用し、即効性のある効率化を狙う目標です。

目標案: 「AI（Copilot等）の活用ワークショップを全課で実施し、四半期末までに部署内での『生成AI活用による事務作業時間削減』を月平均10時間達成する」

狙い: 誰が見ても達成基準が明確（SMART）であり、スピード感を持って成果を出します。

3. 004 (ハインリヒ) モード：定量・KPI特化目標
「逆算思考」を用いて、ビジネスインパクトを数値で測る目標です。

目標案: 「社内DX推進プラットフォームの月間アクティブユーザー（MAU）を80%以上に引き上げ、年間で数千万円規模のライセンスコスト適正化、または工数削減効果を算出・報告する」

狙い: 上層部が最も気にする「投資対効果（ROI）」を、具体的な数値で突きつけます。

4. 002 (ジェット) モード：新規事業・文化醸成目標
「重要思考」を用い、優先順位の高い新たな価値を創造する目標です。

目標案: 「製造現場のデータを活用したリアルタイム検知プロトタイプを1件構築し、現場責任者とのPoCを通じて次年度の本格導入予算を獲得する」

狙い: 既存の枠組みにとらわれない「攻めのDX」を形にします。

```

## FIXME
SWOT分析による「根拠」の明確化

強み(S)・機会(O): 「この新機能は市場のニーズ（機会）に合致しているから、ここを重点的に攻めてシェアを奪う」という攻めの目標が立てやすくなります。

弱み(W)・脅威(T): 「競合の値下げ（脅威）に対し、付加価値提案で対抗する」といった、守りやリスク回避の目標が具体的になります。

4P分析による「アクション」の具体化

営業目標を立てる際、「何を(Product)」「いくらで(Price)」「どこに(Place)」「どうやって(Promotion)」売るかをセットで考えるため、単なる数字目標が「具体的な行動計画」に変わります。

3C分析の構成要素
Customer（市場・顧客）:

市場の規模、成長性、顧客のニーズは何か？
Competitor（競合）:

競合他社はどこか？彼らの強み・弱み、シェア、新製品の動向は？
Company（自社）:

市場ニーズや競合状況を踏まえ、自社の強み・弱み、リソース（ヒト・モノ・カネ）はどうなっているか？
ProsciのJeffrey Hiattが提案したADKAR®モデルという組織変革モデル
- Aware (認識)
- Desire（願望）
- Knowledge（知識）
- Ability（能力）
- Reinforce（強化）

ADAPTフレームワークの5つのステップ
Awareness（認識）

内容: 現在のやり方（ウォーターフォールや形骸化した目標設定）ではうまくいっていない、という危機感や認識を持つこと。

009での活用: 「目標設定に時間がかかりすぎている」「形だけで意味がない」という現状の課題を可視化します。

Desire（欲求）

内容: 「アジャイル（または新しいツール）を使えば課題が解決できるはずだ」という改善への意欲。

009での活用: 「加速装置を使えば、面倒な作業が爆速で終わり、本来のクリエイティブな仕事に集中できる」という期待値を醸成します。

Ability（能力）

内容: 新しい手法を実践するためのスキルや知識を習得すること。

009での活用: Power Appsの操作方法や、Copilotへの適切な指示の出し方を学び、使いこなせる状態にします。

Promotion（促進）

内容: 成功事例を共有し、周囲に広めること。

009での活用: 一部の部署（DX推進室など）で圧倒的な成果を出し、「あのツールを使うと目標設定が楽になるらしい」という噂を広めます。

Transfer（転移）

内容: 組織全体に定着させ、それが「当たり前」の文化になるようにすること。

009での活用: 全社的な標準ツールとして組み込み、新入社員からベテランまでが自然に「加速装置」を使って目標を立てる状態にします。

## 1. Pythonのインストール

まだPythonがインストールされていない場合は、まずPythonをインストールする必要があります。

1.  **Python公式サイトにアクセス:**
    [Python公式ダウンロードページ](https://www.python.org/downloads/windows/)
2.  **インストーラーのダウンロード:**
    最新の安定版Python 3.xの「Windows installer (64-bit)」をダウンロードします。
3.  **インストーラーの実行:**
    ダウンロードした`.exe`ファイルを実行します。
    *   **重要:** インストール開始時に「**Add Python X.Y to PATH**」のチェックボックスを**必ずオン**にしてください。これにより、コマンドプロンプトからPythonが簡単に使えるようになります。
    *   「Install Now」をクリックしてインストールを完了させます。

4.  **インストール確認:**
    コマンドプロンプトを開き、以下のコマンドを実行してPythonが正しくインストールされたか確認します。
    ```bash
    python --version
    pip --version
    ```
    Pythonとpipのバージョンが表示されれば成功です。

## 2. Python仮想環境の構築

プロジェクトごとに独立した環境を構築するために、仮想環境を使用することを強く推奨します。

1.  **プロジェクトディレクトリの作成:**
    任意の場所にプロジェクト用のフォルダを作成し、そのフォルダに移動します。
    例:
    ```bash
    mkdir my_playwright_project
    cd my_playwright_project
    ```

2.  **仮想環境の作成:**
    以下のコマンドを実行して仮想環境を作成します。`venv`は仮想環境の名前です（任意ですが、`venv`が一般的です）。
    ```bash
    python -m venv .venv
    ```

3.  **仮想環境のアクティベート:**
    作成した仮想環境をアクティベートします。これにより、この環境内でインストールされるパッケージは、システム全体のPython環境とは分離されます。
    ```bash
    .\.venv\Scripts\Activate.ps1
    ```
    コマンドプロンプトの表示が `(venv) C:\Users\your_user\my_playwright_project>` のように変われば、アクティベート成功です。

## 3. Playwrightのインストール

仮想環境がアクティベートされた状態で、Playwrightをインストールします。

1.  **Playwrightのインストール:**
    ```bash
    pip install playwright
    ```

2.  **Playwrightブラウザのインストール:**
    Playwrightがサポートするブラウザ（Chromium, Firefox, WebKit）をダウンロードしてインストールします。
    ```bash
    playwright install
    ```
    これにより、必要なブラウザバイナリが自動的にダウンロードされます。

3.  **インストール確認:**
    以下のPythonコードを`test_playwright.py`などのファイルに保存し、実行してPlaywrightが動作するか確認します。

    `test_playwright.py`:
    ```python
    from playwright.sync_api import sync_playwright

    with sync_playwright() as p:
        browser = p.chromium.launch()
        page = browser.new_page()
        page.goto("https://www.google.com")
        print(page.title())
        browser.close()
    ```

    実行コマンド:
    ```bash
    python test_playwright.py
    ```
    Googleのタイトル（例: "Google"）が表示されれば成功です。

## 4. 仮想環境のディアクティベート

作業が完了したら、以下のコマンドで仮想環境をディアクティベートできます。

```bash
deactivate
```

これにより、通常のシステムPython環境に戻ります。再度作業を行う際は、プロジェクトディレクトリで`.\venv\Scripts\activate`を実行して仮想環境をアクティベートしてください。

## 5. キャラクターとモードのコンセプト

このプロジェクトでは、様々な役割を持つキャラクターとモードを想定しています。それぞれのコンセプトは以下の通りです。


